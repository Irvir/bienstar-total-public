import{w as h,r,j as t,E as f,P as g}from"./index-B8jOrRTI.js";const y=()=>{const[u,m]=r.useState({});return r.useEffect(()=>{try{localStorage.getItem("usuario")||(window.location.href="/login")}catch{window.location.href="/login"}},[]),r.useEffect(()=>{const n=document.getElementById("btnPerfilView"),e=document.getElementById("menuDesplegable"),s=document.getElementById("logoutButton"),o=document.getElementById("fotoUsuario");if(!n||!e)return;e.style.position="absolute",e.style.top="8%",e.style.right="8%",e.style.display="none",e.style.width="10%";const l=()=>{e.style.display=e.style.display==="block"?"none":"block"},c=i=>{!n.contains(i.target)&&!e.contains(i.target)&&!o.contains(i.target)&&(e.style.display="none")},a=()=>{localStorage.removeItem("usuario"),window.location.href="login.html"};return n.addEventListener("click",l),document.addEventListener("click",c),s?.addEventListener("click",a),o?.addEventListener("click",()=>{window.location.href="login.html"}),()=>{n.removeEventListener("click",l),document.removeEventListener("click",c),s?.removeEventListener("click",a)}},[]),r.useEffect(()=>{const n=localStorage.getItem("usuario");if(n){const e=JSON.parse(n),s=document.querySelector(".nameUser");s&&(s.textContent=e.name)}},[]),r.useEffect(()=>{const n=window.location.pathname.split("/").pop(),e=document.querySelector("button[onclick*='index.html']"),s=document.querySelector("button[onclick*='alimentos.html']"),o=document.querySelector("button[onclick*='dietas.html']");[e,s,o].forEach(l=>{l?.classList.remove("btnMenuSelec"),l?.classList.add("btnMenu")}),n==="index.html"?e?.classList.add("btnMenuSelec"):n==="alimentos.html"?s?.classList.add("btnMenuSelec"):n==="dietas.html"&&o?.classList.add("btnMenuSelec")},[]),r.useEffect(()=>{async function n(){try{const e=localStorage.getItem("usuario");if(!e)return;const s=JSON.parse(e);if(!s.id_diet||s.id_diet===1)try{const a=await fetch("http://localhost:3001/ensure-diet",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:s.id})});if(a.ok){const i=await a.json();i?.id_diet&&(s.id_diet=i.id_diet,localStorage.setItem("usuario",JSON.stringify(s)))}}catch{}const o=await fetch(`http://localhost:3001/get-diet?id_diet=${s.id_diet}`);if(!o.ok)return;const l=await o.json(),c={};for(const{dia:a,tipo_comida:i,alimento:d}of l)c[a]||(c[a]={}),c[a][i]||(c[a][i]=[]),c[a][i].push(d);m(c)}catch(e){console.error("Error cargando dieta:",e)}}n()},[]),t.jsxs("div",{id:"contenedorPrincipal",className:"dietas-page",children:[t.jsx(f,{activePage:"dietas"}),t.jsxs("main",{id:"cuerpo",children:[t.jsxs("div",{className:"tabla-dieta",children:[t.jsxs("div",{className:"columna-horario",children:[t.jsx("div",{className:"titulo",children:"Días"}),t.jsx("div",{className:"celda",children:"Horario"})]}),["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"].map((n,e)=>{const s=e+1,o=u[s]||{},l=["breakfast","lunch","dinner","snack","snack2"],c={breakfast:"Desayuno",lunch:"Almuerzo",dinner:"Cena",snack:"Snack",snack2:"Snack 2"};return t.jsxs("div",{className:`columna ${n.toLowerCase()}`,"data-dia":s,children:[t.jsx("div",{className:"titulo",children:n}),t.jsx("div",{className:"celda",children:l.map(a=>t.jsxs("div",{className:"bloque-comida",children:[t.jsxs("strong",{children:[c[a],":"]}),o[a]&&o[a].length>0?t.jsx("ul",{className:"lista-comida",children:o[a].map((i,d)=>t.jsx("li",{children:i},d))}):t.jsx("p",{className:"lista-vacia"})]},a))})]},e)})]}),t.jsx("button",{type:"button",id:"BtnCrearCuenta",onClick:()=>window.location.href="/bienstar-total-public/crearDieta",children:"Editar Dieta"})]}),t.jsx(g,{}),t.jsxs("div",{id:"loader",children:[t.jsx("span",{className:"loader-text",children:"Cargando"}),t.jsx("div",{className:"loader-dots"})]})]})},b=h(y,{requireAuth:!0});export{b as default};
